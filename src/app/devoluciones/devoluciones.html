<!-- app.component.html -->
<div class="container mt-3">
  <h5 class="mb-3">Fecha: {{ fechaActual | date : 'dd/MM/yyyy' }}</h5>
  <form [formGroup]="formulario">
    <div *ngFor="let producto of productos; let i = index" class="row align-items-center mb-2">
      <div class="col-4 col-md-3">
        <span class="text-muted small">Código</span>
        <div>{{ producto.codigo }}</div>
      </div>
      <div class="col-6 col-md-6">
        <span class="text-muted small">Descripción</span>
        <div>{{ producto.descripcion }}</div>
      </div>
      <div class="col-2 col-md-3">
        <input
          type="number"
          min="0"
          class="form-control"
          [formControl]="$any(formulario.get('unidades')).at(i)"
          placeholder="Unidades"
        />
      </div>
    </div>
    <button type="button" class="btn btn-success btn-block mt-3" (click)="exportarExcel()">
      Exportar a Excel
    </button>
  </form>
</div>
